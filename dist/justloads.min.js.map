{"version":3,"file":"justloads.min.js","sources":["../src/modules/functions/entries.js","../src/modules/functions/createElement.js","../src/modules/functions/insertElement.js","../src/modules/functions/loadElementPromise.js","../src/modules/functions/loadElement.js","../src/modules/loader/loadJs.js","../src/modules/loader/loadCss.js","../src/modules/functions/capitalizeFirstLetter.js","../src/modules/load.js","../src/modules/features/preloadSupport.js","../src/modules/preloadPolyfill.js","../src/modules/Storage.js","../src/modules/services/LoadStorageService.js","../src/modules/constants/global.js","../src/index.js"],"sourcesContent":["/**\n * generates an generator for better loop through object entries\n *\n * @param {Object} obj\n */\nexport default function* entries(obj) {\n    for (let key of Object.keys(obj)) {\n        yield [\n            key,\n            obj[key]\n        ];\n    }\n}\n","import { d } from './../constants/global';\nimport entries from './entries';\n\n/**\n * Creates an Element with a given type and a number of attributes\n *\n * @param {string} type\n * @param {Object} [attributes]\n * @returns {Element}\n */\nexport default function createElement(type, attributes = {}) {\n    const element = d.createElement(type);\n\n    for (let [key, value] of entries(attributes)) {\n        element.setAttribute(key, value);\n    }\n\n    return element;\n}\n","import {d, getElementsByTagName} from './../constants/global';\n\n/**\n * gets the element head\n * @returns {Element}\n */\nexport function getHead() {\n    return d[getElementsByTagName]('head')[0] || d.documentElement;\n}\n\nconst defaultRefs = (d.body || getHead()).childNodes;\nconst defaultRef = defaultRefs[defaultRefs.length - 1];\n\n/**\n * inserts an element before the given ref or if no reference is given as the last element\n * of the body or head depending on what is already registered\n * @param {Element} element\n * @param {Element} [ref]\n */\nexport default function insertElement(element, ref = defaultRef) {\n    ref.parentNode.insertBefore(element, ref);\n}","import {readyState, onreadystatechange} from './../constants/global';\n\n/**\n *\n * @param element\n * @returns {Promise}\n */\nexport default function loadElementPromise(element) {\n    let complete = false;\n\n    return new Promise(function elementPromises(resolve, reject) {\n        const rejectHandler = function rejectCb(error) {\n                reject(error, element);\n            },\n            resolveHandler = function rejectCb() {\n                resolve(element);\n            };\n\n        if (element[readyState]) {\n            element[onreadystatechange] = function onreadystatechangeHandler() {\n                if (!complete && (element[readyState] === 'complete')) {\n                    complete = true;\n                    resolveHandler();\n                }\n            };\n        } else {\n            element[addEventListener]('load', resolveHandler);\n        }\n\n        element[addEventListener]('error', rejectHandler);\n        element[addEventListener]('abort', rejectHandler);\n    });\n}\n","import loadStorageService from '../services/LoadStorageService';\nimport createElement from './createElement';\nimport insertElement from './insertElement';\nimport loadElementPromise from './loadElementPromise';\n\n/**\n * loads a javascript url if its not loaded\n * @param {string} url\n * @param {string} type\n * @param {Object} [attributes]\n * @return {Promise}\n */\nexport default function loadElement(url, type, attributes = {}) {\n    const element = createElement(type, attributes);\n    let loadedElement = loadStorageService.loaded(url);\n\n    if (loadedElement) {\n        return Promise.resolve(loadedElement);\n    }\n\n    const promise = loadElementPromise(element);\n\n    promise.then(element => loadStorageService.push(url, element), () => {\n    });\n\n    insertElement(element);\n\n    return promise;\n}","import loadElement from './../functions/loadElement';\n\n/**\n *\n * @param url\n * @returns {Promise}\n */\nexport default function loadJs(url) {\n    return loadElement(url, 'script', {\n        async: true,\n        src: url\n    });\n}\n","import loadElement from './../functions/loadElement';\n\n/**\n *\n * @param url\n * @param {string} [media]\n * @returns {Promise}\n */\nexport default function loadCss(url, media = 'all') {\n    const p = loadElement(url, 'link', {\n        type: 'text/css',\n        rel: 'stylesheet',\n        href: url,\n        media: 'only x'\n    });\n\n    p.then(function afterCssLoad(element) {\n        element.media = media; // eslint-disable-line\n    }, () => {\n    });\n\n    return p;\n}\n","/**\n * Capitalizes the first letter\n *\n * @param {string} text\n * @returns {string}\n */\nexport default function capitalizeFirstLetter(text) {\n    return text.charAt(0).toUpperCase() + text.slice(1);\n}","import loadJs from './loader/loadJs';\nimport loadCss from './loader/loadCss';\nimport capitalizeFirstLetter from './functions/capitalizeFirstLetter';\n\nconst loader = {\n    loadJs,\n    loadCss,\n};\n\n/**\n *\n * @param type\n * @returns {*}\n */\nexport default function load(type) {\n    const loaderName = 'load' + capitalizeFirstLetter(type);\n    const args = arguments.length > 1 ? Array.prototype.slice.call(arguments, 1): [];\n\n    return loader[loaderName].apply(null, args);\n}\n","import createElement from './../functions/createElement';\n\n/**\n * checks whether a browser supports pre loading styles or not\n *\n * @return {boolean}\n */\nexport default function preloadSupport() {\n    try {\n        return createElement('link')\n            .relList\n            .supports('preload');\n    } catch (e) {\n        return false;\n    }\n}","import preloadSupport from './features/preloadSupport';\nimport loadCss from './loader/loadCss';\nimport {w, d} from './constants/global';\n\n/**\n *\n */\nfunction polyfill() {\n    const links = d.getElementsByTagName('link');\n\n    for (let i = 0; i < links.length; i += 1) {\n        let link = links[i];\n\n        if (link.rel === 'preload' && link.getAttribute('as') === 'style') {\n            loadCss(link.href);\n            link.rel = null;\n        }\n    }\n}\n\n/**\n *\n */\nexport default function preloadPolyfill() {\n    if (!preloadSupport()) {\n        polyfill();\n        let run = w.setInterval(polyfill, 300);\n\n        w.addEventListener('load', () => {\n            polyfill();\n            w.clearInterval(run);\n        });\n    }\n}","/**\n * Implements a\n */\nexport default class Storage {\n    /**\n     *\n     */\n    constructor() {\n        /**\n         *\n         * @type {Object.<string, Element>}\n         */\n        this.cache = {};\n\n\n    }\n\n    /**\n     *\n     * @param url\n     * @return {Element}\n     */\n    loaded(url) {\n        return this.cache[url];\n    }\n\n    /**\n     *\n     * @param {string} url\n     * @param {Element} elem\n     */\n    push(url, elem) {\n        if (!this.loaded(url)) {\n            this.cache[url] = elem;\n        }\n    }\n\n    /**\n     *\n     * @param {string} url\n     */\n    remove(url) {\n        if (this.loaded(url)) {\n            delete this.cache[url];\n        }\n    }\n}\n","import Storage from '../Storage';\n\nconst loadStorage = new Storage();\n\nexport default loadStorage;\n","\nexport const d = document;\nexport const w = window;\nexport const getElementsByTagName = 'getElementsByTagName';\nexport const readyState = 'readyState';\nexport const onreadystatechange = 'onreadystatechange';","// Import a couple modules for testing.\nimport load from './modules/load';\nimport preloadPolyfill from './modules/preloadPolyfill';\n\npreloadPolyfill();\n\nload('js', '../dist/core.js')\n    .then(() => {\n    })\n    .catch(() => {\n    });\n\nload('css', 'test.css');"],"names":["entries","obj","Object","keys","key","createElement","type","attributes","element","d","value","setAttribute","insertElement","ref","defaultRef","parentNode","insertBefore","loadElementPromise","complete","Promise","resolve","reject","rejectHandler","error","resolveHandler","readyState","onreadystatechange","addEventListener","loadElement","url","loadedElement","loadStorageService","loaded","promise","then","push","loadJs","loadCss","media","p","capitalizeFirstLetter","text","charAt","toUpperCase","slice","load","loaderName","args","arguments","length","Array","prototype","call","loader","apply","preloadSupport","relList","supports","e","polyfill","links","getElementsByTagName","i","link","rel","getAttribute","href","Storage","cache","this","elem","loadStorage","document","w","window","defaultRefs","body","documentElement","childNodes","run","setInterval","clearInterval","catch"],"mappings":"wBAKA,SAAyBA,GAAQC,gIACbC,OAAOC,KAAKF,gGAEpBG,EACAH,EAAIG,6UCChB,QAAwBC,GAAcC,MAAMC,6DAClCC,EAAUC,EAAEJ,cAAcC,sCAEPN,EAAQO,kDAAa,oBAApCH,OAAKM,SACHC,aAAaP,EAAKM,uFAGvBF,GCEX,QAAwBI,GAAcJ,MAASK,0DAAMC,IAC7CC,WAAWC,aAAaR,EAASK,GCbzC,QAAwBI,GAAmBT,MACnCU,IAAW,QAER,IAAIC,SAAQ,SAAyBC,EAASC,MAC3CC,GAAgB,SAAkBC,KACzBA,EAAOf,IAElBgB,EAAiB,aACLhB,GAGZA,GAAQiB,KACAC,GAAsB,WACrBR,GAAqC,aAAxBV,EAAQiB,QACX,UAKXE,kBAAkB,OAAQH,KAG9BG,kBAAkB,QAASL,KAC3BK,kBAAkB,QAASL,KClB3C,QAAwBM,GAAYC,EAAKvB,MAAMC,6DACrCC,EAAUH,EAAcC,EAAMC,GAChCuB,EAAgBC,EAAmBC,OAAOH,MAE1CC,QACOX,SAAQC,QAAQU,MAGrBG,GAAUhB,EAAmBT,YAE3B0B,KAAK,kBAAWH,GAAmBI,KAAKN,EAAKrB,IAAU,gBAGjDA,GAEPyB,ECpBX,QAAwBG,GAAOP,SACpBD,GAAYC,EAAK,iBACb,MACFA,ICFb,QAAwBQ,GAAQR,MAAKS,0DAAQ,MACnCC,EAAIX,EAAYC,EAAK,aACjB,eACD,kBACCA,QACC,oBAGTK,KAAK,SAAsB1B,KACjB8B,MAAQA,GACjB,cAGIC,ECfX,QAAwBC,GAAsBC,SACnCA,GAAKC,OAAO,GAAGC,cAAgBF,EAAKG,MAAM,GCOrD,QAAwBC,GAAKvC,MACnBwC,GAAa,OAASN,EAAsBlC,GAC5CyC,EAAOC,UAAUC,OAAS,EAAIC,MAAMC,UAAUP,MAAMQ,KAAKJ,UAAW,YAEnEK,GAAOP,GAAYQ,MAAM,KAAMP,GCX1C,QAAwBQ,eAETlD,GAAc,QAChBmD,QACAC,SAAS,WAChB,MAAOC,UACE,GCNf,QAASC,SAGA,GAFCC,GAAQnD,EAAEoD,qBAAqB,QAE5BC,EAAI,EAAGA,EAAIF,EAAMX,OAAQa,GAAK,EAAG,IAClCC,GAAOH,EAAME,EAEA,aAAbC,EAAKC,KAAiD,UAA5BD,EAAKE,aAAa,UACpCF,EAAKG,QACRF,IAAM,qwBCZFG,yCASRC,kDAUFvC,SACIwC,MAAKD,MAAMvC,gCAQjBA,EAAKyC,GACDD,KAAKrC,OAAOH,UACRuC,MAAMvC,GAAOyC,kCAQnBzC,GACCwC,KAAKrC,OAAOH,UACLwC,MAAKD,MAAMvC,YCzCxB0C,EAAc,GAAIJ,GCDX1D,EAAI+D,SACJC,EAAIC,OACJb,EAAuB,uBACvBpC,EAAa,aACbC,EAAqB,wBbAT1B,gCEKnB2E,GAAelE,EAAEmE,MAJvB,iBACWnE,GAAEoD,GAAsB,QAAQ,IAAMpD,EAAEoE,oBAGTC,WACpChE,EAAa6D,EAAYA,EAAY1B,OAAS,GMP9CI,wBEmBN,eACSE,IAAkB,QAEfwB,GAAMN,EAAEO,YAAYrB,EAAU,OAEhChC,iBAAiB,OAAQ,iBAErBsD,cAAcF,SIxB5BlC,EAAK,KAAM,mBACNX,KAAK,cAELgD,MAAM,cAGXrC,EAAK,MAAO"}